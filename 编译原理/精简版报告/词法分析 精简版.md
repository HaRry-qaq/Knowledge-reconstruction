#### 词法分析程序单词的归类

- 变量名(variable)
- 关键字(keyword)     C语言共有32个关键字
- 数字常量(number)
  - 整数
  - 小数
  - 科学计数的数字
- 分隔符(界符)、运算符(operator)

keyword与operator具体如下所示。



```C++
// 关键字数组
// C语言关键字共有32个
char *key_word[] = {
    // 数据类型关键字
    "char",
    "short",
    "int",
    "long",
    "signed",
    "unsigned",
    "float",
    "double",
    "struct",
    "union",
    "enum",
    "void",
    // 控制语句关键字
    "for",
    "do",
    "while",
    "break",
    "continue",
    "if",
    "else",
    "goto",
    "switch",
    "case",
    "default",
    "return",
    // 存储类型关键字
    "auto",
    "extern",
    "register",
    "static",
    "typedef",
    // 其他关键字
    "const",
    "sizeof",
    "volatille",
};


// 运算符和界符
char *sign[45] = {
    "[",
    "]",
    "(",
    ")",
    ".",
    "->",
    "-",
    "++",
    "--",
    "*",
    "&",
    "!",
    "~",
    "/",
    "%",
    "+",
    "-",
    "<<",
    ">>",
    ">",
    ">=",
    "<",
    "<=",
    "==",
    "!=",
    "^",
    "|",
    "&&",
    "||",
    "=",
    "/=",
    "*=",
    "%=",
    "+=",
    "-=",
    "<<=",
    ">>=",
    "&=",
    "^=",
    "!=",
    ",",
    ";",
    "{",
    "}",
    "#",
};

```



#### 设计思路

**代码模板参考的是课本上的基础代码，并对其加以改进。**

输出结构：    line x <type， word>

##### ① 给出描述该语言各种单词符号的词法以及规则

- 该点已经在上文给出。

##### ② 构建状态转换图

<img src="C:\Users\HaRry_\AppData\Roaming\Typora\typora-user-images\image-20221106170837938.png" alt="image-20221106170837938" style="zoom:80%;" />

解释：

- 大部分匹配分界符和运算符，以及单行注释的过程都在state = 0时已经处理完毕，由于种类过于繁多，所以这里并没有在状态转换图中体现出来，将会在下一部分的代码展示中给出。
- 由于该状态图表示的是提取一个词法记号的过程，而本次实验为了标注行数，笔者采用了一行一行输入词法分析函数的方式进行读取。而多行注释是跨行的，所以我们需要一个全局变量 multi-annotation 表示当前是否为多行注释状态（跨行后由于词法分析函数的重新调用，state会被清空）。
- 各个状态的解释：
  - 0：初始状态。处理第一个字符判断后续状态的过程。在此状态，简单的分界符和运算符，与单行注释已经处理完毕。
  - 1：word状态。直到读取到不符合变量名规范的字符才会停止。
  - 2：整数状态。遇到小数点会进入小数状态，遇到e或E进入科学计数法状态，否则结束。
  - 3：小数状态。在C中，即使小数点后没有数字，也是正确的。遇到e或E进入科学计数法状态。
  - 4：科学计数法状态。遇到负号进入负幂次状态（事实上，负号前面如果是数字，也是没有错误的，只不过负号后面不是幂次而是减法了）
  - 5：科学计数法负幂次状态。
  - 6：多行注释中读取到 /*的状态。
  - 7：多行注释中读取到 /*  *的状态。